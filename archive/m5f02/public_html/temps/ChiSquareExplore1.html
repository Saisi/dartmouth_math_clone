<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>ChiSquareExplore.html</title><!-- Created by Maple 7.00, APPLE_PPC_MAC --></head><body bgcolor="FFFFFF"><basefont size=3><a name="MapleAutoBookmark1"><p align=left><tt>&gt; </tt><b><font color=#FF0000>"By hitting return you will load a program capable of exploring the Ch-Squared test's validity.":<br><br>with(stats):<br>with(stats[statplots]):<br>Convert:=proc(data)<br>local hap,hap1,d,j1,j2,j3,mean; <br>hap:=[];<br>hap1:=[];<br>d:=[];<br>for j1 from 1 to nops(data)<br>do <br>hap:=[op(hap),data[j1][2]];<br>od;<br>mean := nops(data)*describe[mean](hap);<br>for j2 from 1 to nops(data)<br>do <br>hap1:=[op(hap1), hap[j2]/mean];<br>od;<br>for j3 from 1 to nops(data)<br>do <br>d:=[op(d), [data[j3][1],hap1[j3]]];<br>od;<br>d;<br>end:<br>Bargraph:=proc(data,xmin,xmax,k)<br>local sorteddata,dx,graphicslist,f:<br>sorteddata:=[]:<br>dx:=(xmax-xmin)/k:<br>graphicslist:=[]:<br>sorteddata:=sort(data):<br>if ((op(1,sorteddata)&lt;xmin) or (op(nops(sorteddata),sorteddata)&gt;xmax))<br>then<br>lprint(`Note: some data values lie outside the user-defined interval.`): <br>fi:<br>f:=proc(k,sorteddata,xmin,dx,xmax)<br>local i,j,currentupperlim,leng,index,counter,result,finallist,q,numb,<br>linelist:<br>linelist:=[]: finallist:=[]:<br>index:=1:<br>leng:=nops(sorteddata):<br>currentupperlim:=xmin+dx:<br>result:=[]:<br>for q from 1 to leng do<br>if ((op(q,sorteddata)&gt;=xmin) and (op(q,sorteddata)&lt;=xmax)) <br>then finallist:=[op(finallist),op(q,sorteddata)]<br>fi:<br>od:<br>numb:=nops(finallist):<br>for i from 1 to k do<br>counter:=0:<br>while ((index&lt;=numb) and (op(index,finallist)&lt;=currentupperlim)) do<br>counter:=counter+1:<br>index:=index+1:<br>od:<br>result:=[op(result),counter]:<br>currentupperlim:=currentupperlim+dx:<br>od:<br>for j from 1 to k do<br>linelist:=[op(linelist),[xmin + (j-1)*dx,0]]:<br>linelist:=[op(linelist),[xmin + (j-1)*dx,op(j,result)/leng]]:<br>linelist:=[op(linelist),[xmin + j*dx,op(j,result)/leng]]:<br>linelist:=[op(linelist),[xmin + j*dx,0]]:<br>od:<br>plot(linelist,style=LINE); <br>end:<br>f(k,sorteddata,xmin,dx,xmax):<br>end:Areabargraph:=proc(data,xmin,xmax,k)<br>local sorteddata, dx, lines,graphicslist, f: <br>sorteddata:=[]:<br>dx:=(xmax-xmin)/k:<br>lines:=[]:<br>graphicslist:=[]:<br>sorteddata:=sort(data):<br>if ((op(1,sorteddata)&lt;xmin) or (op(nops(sorteddata),sorteddata)&gt;xmax))<br>then<br>lprint(`Note: some data values lie outside the user-defined interval.`)<br>fi:<br>f:=proc(k,sorteddata,xmin,dx,xmax,lines::evaln)<br>local i,j,currentupperlim,leng,index,counter,result,<br>finallist,q,numb,linelist:<br>finallist:=[]:<br>linelist:=[]:<br>index:=1:<br>leng:=nops(sorteddata):<br>currentupperlim:=xmin+dx:<br>result:=[]:<br>for q from 1 to leng do<br>if ((op(q,sorteddata)&gt;=xmin) and (op(q,sorteddata)&lt;=xmax)) <br>then finallist:=[op(finallist),op(q,sorteddata)]<br>fi:<br>od:<br>numb:=nops(finallist):<br>for i from 1 to k do<br>counter:=0:<br>while ((index&lt;=numb) and (op(index,finallist)&lt;=currentupperlim)) do<br>counter:=counter+1:<br>index:=index+1:<br>od:<br>result:=[op(result),counter]:<br>currentupperlim:=currentupperlim+dx:<br>od:<br>for j from 1 to k do<br>linelist:=[op(linelist),[xmin + (j-1)*dx,0]]:<br>linelist:=[op(linelist),[xmin + (j-1)*dx,op(j,result)/(leng*dx)]]:<br>linelist:=[op(linelist),[xmin + j*dx,op(j,result)/(leng*dx)]]:<br>linelist:=[op(linelist),[xmin + j*dx,0]]:<br>od:<br>lines:=linelist: <br>end:<br>f(k,sorteddata,xmin,dx,xmax,lines):<br>plot(lines,style=LINE);<br>end:<br><br>Analysis:=proc(L)<br>local m,v,sd,k,S,i,j,l;<br>m:=0;<br>v:=0;<br>sd:=0;<br>for k from 1 to nops(L)<br>do <br>m:=m+L[k];<br>od;<br>m:=evalf(m/nops(L));<br>for i from 1 to nops(L)<br>do <br>v:=v+(L[i]-m)^2;<br>od;<br>v:=evalf(v/nops(L));<br>sd:=evalf(sqrt(v));<br>[m,v,sd];<br>end:<br><br>Histogram:=proc(d,n)<br>local list1,j1,j2,A,ml,mh,sl,sh,Al,Ah,L;<br>L:=list1;<br>Al:=Analysis(d);<br>ml:=Al[1];<br>sl:=Al[3];<br>lprint("the Mean is",ml);<br>lprint("the Standard deviation is",sl);<br>lprint("A histogram looks like");<br>Areabargraph(d,min(op(d))-.5,max(op(d))+.5,n ); <br>end: <br><br><br><br>PreChiTest:=proc(E,F)<br>local r,s,i,m;<br>m:=nops(E)-1;<br>r:=0;<br>for i from 1 to nops(E)<br>do<br>r:=r+((E[i]-F[i])^2)/E[i];<br>od;<br>evalf(r);<br>end: <br><br><br>SeeIt:=proc(n)<br>local i,a,N1,N2,N3,N4;<br>N1:=0;<br>N2:=0;<br>N3:=0;<br>N4:=0;<br>for i from 1 to  n<br>do<br>a:=stats[random,discreteuniform[1,4]](1);<br>if a=1 then<br>N1:=N1+1;<br>fi;<br>if a=2 then<br>N2:=N2+1;<br>fi;<br>if a=3 then<br>N3:=N3+1;<br>fi;<br>if a=4 then<br>N4:=N4+1;<br>fi;<br>od;<br>PreChiTest(<br>[evalf(n*.25),evalf(n*.25),evalf(n*.25),evalf(n*.25)],<br>[N1,N2,N3,N4]);<br><br>end:<br><br>SeeItAll:=proc(n,m,k)<br>local i,S;<br>S:=[];<br>for i from 1 to m<br>do<br>S:=[op(S),SeeIt(n)];<br>od;<br>S;<br><br>A1:=plot(stats[statevalf,pdf,chisquare[3]](x),x=0..15,color=blue):<br><br>A2:=Histogram(S,k);<br><br>display(A1,A2);<br><br>end:<br></font></b></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, the name transform has been redefined<br></font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, `A1` is implicitly declared local to procedure `SeeItAll`<br></font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, `A2` is implicitly declared local to procedure `SeeItAll`<br></font></pre></tt></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>SeeItAll(100,5000,13);</font></b></p><p align=left><tt><pre><font color=#0000FF size=2>"the Mean is", 3.022608000</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"the Standard deviation is", 2.475035722</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"A histogram looks like"</font></pre></tt></p><p align=center><img src="http://www.math.dartmouth.edu/~m5f02/temps/chi/ChiSquareExplore1.gif" width=337 height=250 alt="[Maple Plot]"></p></basefont></body></html>