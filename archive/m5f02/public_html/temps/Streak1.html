<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Streak.html</title><!-- Created by Maple 7.00, APPLE_PPC_MAC --></head><body bgcolor="FFFFFF"><basefont size=3><a name="MapleAutoBookmark1"><p align=left><tt>&gt; </tt><b><font color=#FF0000>"By hitting return you will load a hopefully useful histogram program":<br><br>with(stats):<br>with(stats[statplots]):<br>Convert:=proc(data)<br>local hap,hap1,d,j1,j2,j3,mean; <br>hap:=[];<br>hap1:=[];<br>d:=[];<br>for j1 from 1 to nops(data)<br>do <br>hap:=[op(hap),data[j1][2]];<br>od;<br>mean := nops(data)*describe[mean](hap);<br>for j2 from 1 to nops(data)<br>do <br>hap1:=[op(hap1), hap[j2]/mean];<br>od;<br>for j3 from 1 to nops(data)<br>do <br>d:=[op(d), [data[j3][1],hap1[j3]]];<br>od;<br>d;<br>end:<br>Bargraph:=proc(data,xmin,xmax,k)<br>local sorteddata,dx,graphicslist,f:<br>sorteddata:=[]:<br>dx:=(xmax-xmin)/k:<br>graphicslist:=[]:<br>sorteddata:=sort(data):<br>if ((op(1,sorteddata)&lt;xmin) or (op(nops(sorteddata),sorteddata)&gt;xmax))<br>then<br>lprint(`Note: some data values lie outside the user-defined interval.`): <br>fi:<br>f:=proc(k,sorteddata,xmin,dx,xmax)<br>local i,j,currentupperlim,leng,index,counter,result,finallist,q,numb,<br>linelist:<br>linelist:=[]: finallist:=[]:<br>index:=1:<br>leng:=nops(sorteddata):<br>currentupperlim:=xmin+dx:<br>result:=[]:<br>for q from 1 to leng do<br>if ((op(q,sorteddata)&gt;=xmin) and (op(q,sorteddata)&lt;=xmax)) <br>then finallist:=[op(finallist),op(q,sorteddata)]<br>fi:<br>od:<br>numb:=nops(finallist):<br>for i from 1 to k do<br>counter:=0:<br>while ((index&lt;=numb) and (op(index,finallist)&lt;=currentupperlim)) do<br>counter:=counter+1:<br>index:=index+1:<br>od:<br>result:=[op(result),counter]:<br>currentupperlim:=currentupperlim+dx:<br>od:<br>for j from 1 to k do<br>linelist:=[op(linelist),[xmin + (j-1)*dx,0]]:<br>linelist:=[op(linelist),[xmin + (j-1)*dx,op(j,result)/leng]]:<br>linelist:=[op(linelist),[xmin + j*dx,op(j,result)/leng]]:<br>linelist:=[op(linelist),[xmin + j*dx,0]]:<br>od:<br>plot(linelist,style=LINE); <br>end:<br>f(k,sorteddata,xmin,dx,xmax):<br>end:Areabargraph:=proc(data,xmin,xmax,k)<br>local sorteddata, dx, lines,graphicslist, f: <br>sorteddata:=[]:<br>dx:=(xmax-xmin)/k:<br>lines:=[]:<br>graphicslist:=[]:<br>sorteddata:=sort(data):<br>if ((op(1,sorteddata)&lt;xmin) or (op(nops(sorteddata),sorteddata)&gt;xmax))<br>then<br>lprint(`Note: some data values lie outside the user-defined interval.`)<br>fi:<br>f:=proc(k,sorteddata,xmin,dx,xmax,lines::evaln)<br>local i,j,currentupperlim,leng,index,counter,result,<br>finallist,q,numb,linelist:<br>finallist:=[]:<br>linelist:=[]:<br>index:=1:<br>leng:=nops(sorteddata):<br>currentupperlim:=xmin+dx:<br>result:=[]:<br>for q from 1 to leng do<br>if ((op(q,sorteddata)&gt;=xmin) and (op(q,sorteddata)&lt;=xmax)) <br>then finallist:=[op(finallist),op(q,sorteddata)]<br>fi:<br>od:<br>numb:=nops(finallist):<br>for i from 1 to k do<br>counter:=0:<br>while ((index&lt;=numb) and (op(index,finallist)&lt;=currentupperlim)) do<br>counter:=counter+1:<br>index:=index+1:<br>od:<br>result:=[op(result),counter]:<br>currentupperlim:=currentupperlim+dx:<br>od:<br>for j from 1 to k do<br>linelist:=[op(linelist),[xmin + (j-1)*dx,0]]:<br>linelist:=[op(linelist),[xmin + (j-1)*dx,op(j,result)/(leng*dx)]]:<br>linelist:=[op(linelist),[xmin + j*dx,op(j,result)/(leng*dx)]]:<br>linelist:=[op(linelist),[xmin + j*dx,0]]:<br>od:<br>lines:=linelist: <br>end:<br>f(k,sorteddata,xmin,dx,xmax,lines):<br>plot(lines,style=LINE);<br>end:<br><br>Analysis:=proc(L)<br>local m,v,sd,k,S,i,j,l;<br>m:=0;<br>v:=0;<br>sd:=0;<br>for k from 1 to nops(L)<br>do <br>m:=m+L[k];<br>od;<br>m:=evalf(m/nops(L));<br>for i from 1 to nops(L)<br>do <br>v:=v+(L[i]-m)^2;<br>od;<br>v:=evalf(v/nops(L));<br>sd:=evalf(sqrt(v));<br>[m,v,sd];<br>end:<br><br>Histogram:=proc(d,n)<br>local list1,j1,j2,A,ml,mh,sl,sh,Al,Ah,L;<br>L:=list1;<br>Al:=Analysis(d);<br>ml:=Al[1];<br>sl:=Al[3];<br>lprint("the Mean is",ml);<br>lprint("the Standard deviation is",sl);<br>lprint("A histogram looks like");<br>Areabargraph(d,min(op(d))-.5,max(op(d))+.5,n ); <br>end: <br><br>"Here is program that will help you analyze how you expect streaks to behave. Hit return to load it.":<br><br><br>with(stats):<br>with(stats[statplots]):<br>Areabargraph:=proc(data,xmin,xmax,k)<br>local sorteddata, dx, lines,graphicslist, f: <br>sorteddata:=[]:<br>dx:=(xmax-xmin)/k:<br>lines:=[]:<br>graphicslist:=[]:<br>sorteddata:=sort(data):<br>if ((op(1,sorteddata)&lt;xmin) or (op(nops(sorteddata),sorteddata)&gt;xmax)) then<br>lprint(`Note: some data values lie outside the user-defined interval.`)<br>fi:<br>f:=proc(k,sorteddata,xmin,dx,xmax,lines::evaln)<br>local i,j,currentupperlim,leng,index,counter,result,<br>finallist,q,numb,linelist:<br>finallist:=[]:<br>linelist:=[]:<br>index:=1:<br>leng:=nops(sorteddata):<br>currentupperlim:=xmin+dx:<br>result:=[]:<br>for q from 1 to leng do<br>if ((op(q,sorteddata)&gt;=xmin) and (op(q,sorteddata)&lt;=xmax)) <br>then finallist:=[op(finallist),op(q,sorteddata)]<br>fi:<br>od:<br>numb:=nops(finallist):<br>for i from 1 to k do<br>counter:=0:<br>while ((index&lt;=numb) and (op(index,finallist)&lt;=currentupperlim)) do<br>counter:=counter+1:<br>index:=index+1:<br>od:<br>result:=[op(result),counter]:<br>currentupperlim:=currentupperlim+dx:<br>od:<br>for j from 1 to k do<br>linelist:=[op(linelist),[xmin + (j-1)*dx,0]]:<br>linelist:=[op(linelist),[xmin + (j-1)*dx,op(j,result)/(leng*dx)]]:<br>linelist:=[op(linelist),[xmin + j*dx,op(j,result)/(leng*dx)]]:<br>linelist:=[op(linelist),[xmin + j*dx,0]]:<br>od:<br>lines:=linelist: <br>end:<br>f(k,sorteddata,xmin,dx,xmax,lines):<br>plot(lines,style=LINE);<br>end:<br>Spikegraph:=proc(distributionlist,xmin,xmax,show)<br>local num,linelist,j,i,templist:<br>templist:=[]:<br>if ((distributionlist[1][1]&lt;xmin) or <br>(distributionlist[nops(distributionlist)][1]&gt;xmax)<br>) then<br>lprint(`Note: some data values lie outside the user-defined interval.`)<br>fi:<br>for i from 1 to nops(distributionlist) do<br>if not((distributionlist[i][1]&lt;xmin) or (distributionlist[i][1]&gt;xmax)) then<br>templist:=[op(templist),<br>[distributionlist[i][1],<br>distributionlist[i][2]<br>]<br>]:<br>fi:<br>od:<br>num:=nops(templist):<br>linelist:=[]:<br>for j from 1 to num do<br>linelist:=[op(linelist),[templist[j][1],0]]:<br>linelist:=[op(linelist),[templist[j][1],templist[j][2]]]:<br>linelist:=[op(linelist),[templist[j][1],0]]:<br>od:<br>if show then plot(linelist,style=LINE) fi;<br>end:<br>SpikeData:=proc(data)<br>local sorteddata,i,olist,plist,current,j,temp,distributionlist:<br>olist:=sort(convert(convert(data,set),list)): <br>sorteddata:=sort(data):<br>plist:=[seq(0,j=1..nops(olist))]: current:=1: <br>for i from 1 to nops(data) do<br>if op(i,sorteddata)=op(current,olist)<br>then<br>temp:=op(current,plist):<br>plist:=subsop(current=temp+1,plist):<br>else<br>current:=current+1:<br>temp:=op(current,plist):<br>plist:=subsop(current=temp+1,plist)<br>fi:<br>od:<br>plist:=map(proc(x,data) evalf(x/nops(data)) end,plist,data):<br>distributionlist:=zip(proc(x,y) [x,y] end,olist,plist):<br>distributionlist:<br>end:<br><br><br><br><br>Maxrun:=proc(n,p)<br>local list,k,R,t:<br>R:=[];t:=1;<br>list:=[stats[random, empirical[p/100,(100-p)/100]](n)];<br>for k from 2 to n<br>do<br>if <br>list[k] = list[k-1]<br>then <br>t:=t+1;<br>fi;<br>if list[k] &lt;&gt; list[k-1] <br>then <br>R:=[op(R),t];<br>t:=1;  <br>fi;<br>od;<br>R;<br>end:<br><br>Streak:=proc(n,p,m,V)<br>local list,k,R,t:<br>list:=[];<br>for k from 1 to m<br>do<br>list:=[op(list),max(op(Maxrun(n,p)))];<br>od;<br>lprint("Letting heads occur with a",p,"percent chance,");<br>lprint("the avergae maxiamal legnth run of heads in",m);<br>lprint("randomly choosen lists of legnth",n,"has been found to be");<br>lprint(evalf(describe[mean](list)));<br>lprint("with the following histogram");<br><br>Histogram(list,12);<br><br>end:<br><br>"This program is not desrcibed be low. It gives the eact epected value and a simulated value together ": <br><br><br>Streaky:=proc(n,p,V)<br>local list,k,R,t:<br>R:=[];t:=1;<br>list:=[stats[random, empirical[p/100,(100-p)/100]](n)];<br>for k from 2 to n<br>do<br>if <br>list[k] = list[k-1] and list[k]=1<br>then <br>t:=t+1;<br>fi;<br>if list[k] &lt;&gt; list[k-1] or list[k]=2<br>then <br>R:=[op(R),t] <br>fi;<br>if <br>list[k] &lt;&gt; list[k-1]<br>then <br>t:=1; <br>fi;<br>od;<br>lprint("the actual expect value is about",<br>evalf(((log[100/p](n*(1-p/100)))+.577/ln(100/p)-0.5)));<br>if V = true then<br>lprint(max(op(R)));<br>fi;<br>if V = false <br>then <br>lprint(R);<br>fi;<br>end: </font></b></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, these names have been redefined: anova, describe, fit, importdata, random, statevalf, statplots, transform<br></font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, these names have been redefined: boxplot, histogram, scatterplot, xscale, xshift, xyexchange, xzexchange, yscale, yshift, yzexchange, zscale, zshift<br></font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, these names have been redefined: anova, describe, fit, importdata, random, statevalf, statplots, transform<br></font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, these names have been redefined: boxplot, histogram, scatterplot, xscale, xshift, xyexchange, xzexchange, yscale, yshift, yzexchange, zscale, zshift<br></font></pre></tt></p><p align=left><tt>&gt; </tt><b><font color=#FF0000> Streak(200,50,5000,true); </font></b></p><p align=left><tt><pre><font color=#0000FF size=2>"Letting heads occur with a", 50, "percent chance,"</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"the avergae maxiamal legnth run of heads in", 5000</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"randomly choosen lists of legnth", 200, "has been found to be"</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>7.950400000</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"with the following histogram"</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"the Mean is", 7.950400000</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"the Standard deviation is", 1.821521258</font></pre></tt></p><p align=left><tt><pre><font color=#0000FF size=2>"A histogram looks like"</font></pre></tt></p><p align=center></p><p align=left><tt>&gt; </tt></p></basefont></body></html>