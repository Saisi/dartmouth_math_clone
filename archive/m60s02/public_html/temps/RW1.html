<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>RW.html</title><!-- Created by Maple 7.00, APPLE_PPC_MAC --></head><body bgcolor="FFFFFF"><basefont size=3><a name="MapleAutoBookmark1"><p align=left><tt>&gt; </tt><b><font color=#FF0000>with(stats):<br><br>with(plots):<br><br> Areabargraph:=proc(data,xmin,xmax,k) <br>local sorteddata, dx, lines,graphicslist, f: sorteddata:=[]: dx:=(xmax-xmin)/k: lines:=[]: graphicslist:=[]:<br>### WARNING: incomplete quoted name;  use ` to end the name<br>sorteddata:=sort(data): if ((op(1,sorteddata)&lt;xmin) or (op(nops(sorteddata),sorteddata)&gt;xmax)) then lprint(`Note: some data<br>values lie outside the user-defined interval.`) fi: f:=proc(k,sorteddata,xmin,dx,xmax,lines::evaln) local<br>i,j,currentupperlim,leng,index,counter,result, finallist,q,numb,linelist: finallist:=[]: linelist:=[]: index:=1:<br>leng:=nops(sorteddata): currentupperlim:=xmin+dx: result:=[]: for q from 1 to leng do if ((op(q,sorteddata)&gt;=xmin) and<br>(op(q,sorteddata)&lt;=xmax)) then finallist:=[op(finallist),op(q,sorteddata)] fi: od: numb:=nops(finallist): for i from 1 to k<br>do counter:=0: while ((index&lt;=numb) and (op(index,finallist)&lt;=currentupperlim)) do counter:=counter+1: index:=index+1: od:<br>result:=[op(result),counter]: currentupperlim:=currentupperlim+dx: od: for j from 1 to k do linelist:=[op(linelist),[xmin +<br>(j-1)*dx,0]]: linelist:=[op(linelist),[xmin + (j-1)*dx,op(j,result)/(leng*dx)]]: linelist:=[op(linelist),[xmin +<br>j*dx,op(j,result)/(leng*dx)]]: linelist:=[op(linelist),[xmin + j*dx,0]]: od: lines:=linelist: end:<br>f(k,sorteddata,xmin,dx,xmax,lines): plot(lines,style=LINE); end: <br><br>Walk:=proc(n,sd,T)<br>local L,H,i,M1,M2,M3,V,var;<br>var:=sd^2;<br>H:=[[0,0]];<br>V:=0;<br>L:=[random[discreteuniform[0,1]](n)];<br>for i from 1 to n<br>do<br>V:=V+2*(L[i]-.5)*sqrt(var*T/n);<br>H:=[op(H),[i*T/n,V]];<br>od;<br>M1:=listplot(H, color=red);<br>M2:=plot(sqrt(var*x),x=0..T,color=blue);<br>M3:=plot(-1*sqrt(var*x),x=0..T,color=blue);<br>display(M1,M2,M3);<br>end:<br><br><br>Walk2:=proc(n,sd,T,m)<br>local L,H,i,M1,M2,M3,V,var,k,J,c,U,V1;<br>var:=sd^2;<br>c:=evalf(sqrt(var*T/n));<br>J:=[];<br>for k from 1 to m<br>do;<br>H:=[[0,0]];<br>V:=0;<br>L:=[random[discreteuniform[0,1]](n)];<br>for i from 1 to n<br>do<br>V:=V+2*(L[i]-.5)*c;<br>H:=[op(H),[i*T/n,V]];<br>od;<br>J:=[op(J),H[n][2]]<br>od;<br>J;<br>U := Areabargraph(J,min(op(J)),max(op(J)),10); <br>V1 := plot((1/(sqrt(2*Pi*T*var)))*exp(-x^2/(T*var*2)),x =min(op(J))..max(op(J)));<br> display({U,V1});<br><br>end:<br><br></font></b></p><p align=left><tt><pre><font color=#0000FF size=2>Warning, the name changecoords has been redefined<br></font></pre></tt></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Walk(500,5,2);</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW1.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Walk2(500,5,2,300);</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW2.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy:=proc(n,sd,T,I0)<br>local L,H,i,M1,M2,M3,V,var,d,W,j,J;<br>d:=evalf(T/n);<br>var:=sd^2;<br>H:=[[0,I0]];<br>V:=I0;<br>L:=[random[discreteuniform[0,1]](n)];<br>for i from 1 to n<br>do<br>V:=V+d*V+2*(L[i]-.5)*sqrt(var*T/n);<br>H:=[op(H),[i*T/n,V]];<br>od;<br><br>J:=[[0,I0]];<br>W:=I0;<br>for j from 1 to n<br>do<br>W:=W+d*W;<br>J:=[op(J),[j*T/n,W]];<br>od;<br><br>M1:=listplot(H, color=red);<br>M2:=listplot(J, color=blue);<br>display(M1,M2);<br><br>end:<br></font></b></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy(500,1,2,1);</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW3.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy:=proc(n,sd,T,I0,f)<br>local L,H,i,M1,M2,M3,V,var,d,W,j,J;<br>d:=evalf(T/n);<br>var:=sd^2;<br>H:=[[0,I0]];<br>V:=I0;<br>L:=[random[discreteuniform[0,1]](n)];<br>for i from 1 to n<br>do<br>V:=evalf(V+d*subs(x=V,f)+2*(L[i]-.5)*sqrt(var*T/n));<br>H:=[op(H),[i*T/n,V]];<br>od;<br>J:=[[0,I0]];<br>W:=I0;<br>for j from 1 to n<br>do<br>W:=W+d*subs(x=W,f);<br>J:=[op(J),[j*T/n,W]];<br>od;<br>M1:=listplot(H, color=red);<br>M2:=listplot(J, color=blue);<br>display(M1,M2);<br><br>end:</font></b></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy(500,1,2,1,x);</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW4.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy(500,3,1,1,x*(10-x));</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW5.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy(500,5,2,60,.1*x*(30-x));</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW6.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy(500,1,3,2,(x-5)^2);</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW7.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt><b><font color=#FF0000>Diffy(500,1,4,2,(x-5)^2);</font></b></p><p align=center><img src="http://www.math.dartmouth.edu/~m60s02/temps/StiD/RW8.gif" width=337 height=250 alt="[Maple Plot]"></p><p align=left><tt>&gt; </tt></p></basefont></body></html>